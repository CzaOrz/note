<!-- https://www.sohu.com/a/240724502_713245 -->
<!-- https://www.pianshen.com/article/7056846715/ -->

# Little's Law

工业工程领域的定律，即在长期稳定的系统中有这么一个公式：`L = λW` 
平均顾客数量 = 平均顾客到达率 * 顾客平均消耗时间  

* 在一个网络系统中，假设我们的缓冲区可以缓冲1000个请求，每个请求的平均服务时间为0.001秒（1ms），那么这个系统每秒最多能处理多少个需求
    * 条件指明最多，则先计算满载时平均消耗时间 1000 * 0.001 = 1s
    * 通过计算公式，`λ = L / W = 1000 / 1 = 1000`，即每秒最多处理1000个请求
* 假设我们观察到向一个系统发送请求，平均20ms就能得到响应，并且该系统每秒能处理大约1000个请求，那么是否能推测出该系统的缓冲区长度
    * 初步得到指标为`λ = 1000 QPS`，而且平均响应时间为 20ms，则可以计算出并发为：`1000 * 20 * 0.001 = 20`
* 假定我们所开发的并发服务器，并发的访问速率是：1000客户/分钟，每个客户在该服务器上将花费平均0.5分钟，
根据little'slaw规则，在任何时刻，服务器将承担1000×0.5＝500个客户量的业务处理。
假定过了一段时间，由于客户群的增大，并发的访问速率提升为2000客户/分钟。在这样的情况下，我们该如何改进我们系统的性能
    * 提高服务并发处理业务量
    * 减少服务器平均处理客户请求
* 假设你排队参观某个风景点，该风景点固定的容纳人数是：60人。每个人在该风景点停留的平均时间是：3分钟。假设在你的前面还排有20个人，问：你估计你大概等多少时间才能进入该风景点
    * 20 * 3 = 60

# QPS 和 并发数

QPS：表示单位时间内平均处理请求的数量  
耗时：表示处理单次请求所耗费时间  
并发数：系统中同时处理的请求数  

* 大一新生的招收速度是5000人/年，每个学生在大学停留4年，整个大学的人数是20000，于是(下面的QPS改为以年为单位)
    * QPS：5000 人/年
    * 耗时：4年
    * 并发：20000人
* 180000员工，必须早上8:30-9:00之间在考勤系统签到，每次签到在系统需要停留0.1秒，于是：
    * QPS：180000 / (30 * 60) = 100 人/秒
    * 耗时：0.1s
    * 并发：100 * 0.1 = 10人
* 每秒有1个人进入动物园，每个人在动物园中停留2小时，于是：
    * QPS：1 人/秒
    * 耗时：2*60*60 = 7200s
    * 并发：7200人


